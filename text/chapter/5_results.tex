The baseline is to look at the effects of ToMe (with default settings) applied to $768 \times 768$ images. The experiments can be split up into three different parts inspecting how ToMe affects performance\\ \(1)\) when applied to different parts of the transformer,\\ \(2)\) when applied to smaller $512 \times 512$ images and\\ \(3)\) when different settings for partitioning the \textbf{src} and \textbf{dst} set are used.

\subsubsection*{1): Experimenting with different components of the transformer}
ToMe's default configuration involves token merging solely within the self-attention module.\\
Our experiment aims to gauge how the performance metrics are affected by extending token merging to different combinations of transformer components.

\subsubsection*{1.1): default (only self-attn) vs all (self-attn, cross-attn and mlp)}
\begin{figure}[!htb]
   \input{plots/plot1_fid}
   \input{plots/plot1_time}
\end{figure}
Test1

\newpage
\subsubsection*{1.2): default vs self-attn \& cross-attn vs self-attn \& mlp}
\begin{figure}[!htb]
    \input{plots/plot2_fid}
    \input{plots/plot2_time}
\end{figure}

\subsubsection*{1.3): default vs cross-attn \& mlp vs only cross-attn}
\begin{figure}[!htb]
    \input{plots/plot5_fid}
    \input{plots/plot5_time}
\end{figure}

\newpage
\subsubsection*{1.4): default vs self-attn \& cross-attn (the second time)}
Note that FID doesnâ€™t consider prompt adherance, which is likely why merging the cross attn module actually reduces FID. (Still relevent with different expermient setup??)
\begin{figure}[!htb]
    \input{plots/plot3_fid}
    \input{plots/plot3_time}
\end{figure}

\newpage
\subsubsection*{2): Exploring different images sizes}
Text.
\subsubsection*{2.1): Moving to smaller images}
Test1
\begin{figure}[!htb]
    \input{plots/plot4_fid}
    \input{plots/plot4_time}
\end{figure}

\newpage
\subsubsection*{3): Exploring different strides}
\subsubsection*{3.1): $3 \times 3$ stride}
Test1
\subsubsection*{3.2): $1 \times 2$ vertical stride}
\begin{align*}
    r_{max} = 1-\frac{1}{1*2} = 50\%
\end{align*}
Every  \textbf{src} token has to merged when \(r=50\%\) because \(r=r_{max}\) now so the advantage starts to fade.

\begin{figure}[!htb]
    \input{plots/plot6_fid}
    \input{plots/plot6_time}
\end{figure}

\newpage
\subsubsection*{4): Putting it all together}
Averages of default by \cite{bolya2023tomesd}, improvement by using selt-attn and cross-attn, improvement by using 1x2 strides. 
self-attn and cross-attn with 2x2 strides for best time performance. self-attn and cross-attn with 1x2 strides for best quality (low FID) performance.
\begin{figure}[!htb]
    \input{plots/plot7_fid}
    \input{plots/plot7_time}
\end{figure}